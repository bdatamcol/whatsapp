(()=>{var e={};e.id=998,e.ids=[998],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},77664:(e,t,s)=>{"use strict";s.r(t),s.d(t,{patchFetch:()=>m,routeModule:()=>p,serverHooks:()=>l,workAsyncStorage:()=>u,workUnitAsyncStorage:()=>d});var r={};s.r(r),s.d(r,{GET:()=>c});var a=s(96559),n=s(48088),o=s(37719),i=s(32190);async function c(e){let{searchParams:t}=new URL(e.url),s=t.get("limit")||"20",r=t.get("after")||"";try{let e=`https://graph.facebook.com/v17.0/act_${process.env.FACEBOOK_AD_ACCOUNT_ID}/insights?fields=date_start,date_stop,spend,impressions,reach,clicks,unique_clicks,cpc,ctr,frequency,campaign_name,adset_name,ad_name,actions&level=ad&limit=${s}&access_token=${process.env.FACEBOOK_ACCESS_TOKEN}`+(r?`&after=${r}`:""),t=await fetch(e,{method:"GET"});if(console.log("Status Code:",t.status),!t.ok){let e=await t.json();return console.log("Error Message:",e),i.NextResponse.json({error:e.error.message},{status:500})}let a=await t.json();console.log("Datos recibidos:",a);let n=a.data.map(e=>({dateStart:e.date_start||"N/A",dateStop:e.date_stop||"N/A",spend:parseFloat(e.spend)||0,impressions:parseInt(e.impressions)||0,reach:parseInt(e.reach)||0,clicks:parseInt(e.clicks)||0,uniqueClicks:parseInt(e.unique_clicks)||0,cpc:parseFloat(e.cpc)||0,ctr:parseFloat(e.ctr)||0,frequency:parseFloat(e.frequency)||0,campaignName:e.campaign_name||"N/A",adsetName:e.adset_name||"N/A",adName:e.ad_name||"N/A",effectiveStatus:e.effective_status||"N/A",actions:e.actions?e.actions.map(e=>({actionType:e.action_type||"N/A",value:parseInt(e.value)||0})):[]}));return i.NextResponse.json({data:n,paging:a.paging})}catch(e){return console.error("Error interno:",e.message||e),i.NextResponse.json({error:e.message||"Error desconocido"},{status:500})}}let p=new a.AppRouteRouteModule({definition:{kind:n.RouteKind.APP_ROUTE,page:"/api/marketing/insights/route",pathname:"/api/marketing/insights",filename:"route",bundlePath:"app/api/marketing/insights/route"},resolvedPagePath:"C:\\Users\\EQUIPO 2\\whatsapp-clean\\src\\app\\api\\marketing\\insights\\route.ts",nextConfigOutput:"",userland:r}),{workAsyncStorage:u,workUnitAsyncStorage:d,serverHooks:l}=p;function m(){return(0,o.patchFetch)({workAsyncStorage:u,workUnitAsyncStorage:d})}},78335:()=>{},96487:()=>{}};var t=require("../../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[719,580],()=>s(77664));module.exports=r})();